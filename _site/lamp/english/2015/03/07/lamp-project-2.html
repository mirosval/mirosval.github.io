<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Mirosval</title>

    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css">

    <link href='//fonts.googleapis.com/css?family=Open+Sans:300,700&amp;subset=latin,latin-ext' rel='stylesheet' type='text/css'>
    
    <link rel="alternate" type="application/rss+xml" title="Mirosval" href="http://mirosval.github.io/feed.xml">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        
        <a href="/" class="profile-picture-link">
          <img src="/images/cuba.jpg" alt="Profile Picture Mirosval" class="profile-picture">
        </a>

        <p></p>
        <h1>Mirosval</h1>

        <p class="view">
          <a href="https://github.com/mirosval">My GitHub</a>
          <a href="https://twitter.com/mirosva1">My Twitter</a>
        </p>

        <div class="categories">
          <h3>Categories</h3>
          <ul class="categories">
            
              <li>
                <a href="/categories/english">
                  English (11)
                </a>
              </li>
            
              <li>
                <a href="/categories/master-thesis">
                  Master thesis (5)
                </a>
              </li>
            
              <li>
                <a href="/categories/other">
                  Other (5)
                </a>
              </li>
            
              <li>
                <a href="/categories/python">
                  Python (4)
                </a>
              </li>
            
              <li>
                <a href="/categories/slovak">
                  Slovak (3)
                </a>
              </li>
            
              <li>
                <a href="/categories/lamp">
                  Lamp (2)
                </a>
              </li>
            
          </ul>
        </div>

        <div class="tags">
          <h3>Tags</h3>
          <ul class="tags">
            
              <li style="font-size: 110%">
                <a href="/tags/master-thesis">
                  Master thesis (5)
                </a>
              </li>
            
              <li style="font-size: 110%">
                <a href="/tags/opencv">
                  Opencv (5)
                </a>
              </li>
            
              <li style="font-size: 150%">
                <a href="/tags/python">
                  Python (9)
                </a>
              </li>
            
              <li style="font-size: 70%">
                <a href="/tags/pupil">
                  Pupil (1)
                </a>
              </li>
            
              <li style="font-size: 80%">
                <a href="/tags/iris">
                  Iris (2)
                </a>
              </li>
            
              <li style="font-size: 70%">
                <a href="/tags/safari-extension">
                  Safari extension (1)
                </a>
              </li>
            
              <li style="font-size: 80%">
                <a href="/tags/performance">
                  Performance (2)
                </a>
              </li>
            
              <li style="font-size: 90%">
                <a href="/tags/hardware">
                  Hardware (3)
                </a>
              </li>
            
              <li style="font-size: 80%">
                <a href="/tags/arduino">
                  Arduino (2)
                </a>
              </li>
            
              <li style="font-size: 70%">
                <a href="/tags/ios">
                  Ios (1)
                </a>
              </li>
            
          </ul>
        </div>
      </header>

    <section class="content">
        <h2>Lamp Project&#58; The Hardware Prototype</h2>
        <span class="published">Published 7 March 2015</span>
        <p>The detailed description of the prototype hardware used for the lamp project.</p>

<hr />

<p><a href="/lamp/english/2015/01/18/lamp-project.html">Project Overview</a></p>

<p>I have, obviously, started with an idea. I didn’t like any of the exisiting smart lamp solutions, mostly because they lacked customizability. So my thought process was to start with some minimal requirements. I have come up with the following:</p>

<ul>
  <li>RGB LED Strip for the actual light</li>
  <li>Bluetooth for controls</li>
  <li>Some sort of Arduino to process it all</li>
</ul>

<p><img src="/images/lamp-hw/finished-board.jpg" alt="Finished prototype board" /></p>

<h2 id="choosing-the-rgb-led-strip">Choosing the RGB LED Strip</h2>

<p>There are lots of different options, there are single-color strips, RGB strips or <a href="http://www.adafruit.com/products/1138">programmable strips</a>, where you can change the color of every single LED. I though I would be fine with just controlling the color of the entire strip so I went with something like <a href="http://www.ebay.com/itm/5M-5050-RGB-SMD-LED-Waterproof-Flexible-Strip-300-LEDs-44-Key-IR-Remote-/180992529478">this</a>.</p>

<p>I don’t need the stupid IR controller, but I found that sometimes you can get the same thing <em>with</em> the controller for less than without it. The key characteristics are:</p>

<ul>
  <li>SMD 5050 - this represents the size of a single LED</li>
  <li>60 LED/m - I want this to be bright</li>
  <li>12V DC - operating voltage</li>
  <li>1A/m - required current per 1 meter of the strip</li>
</ul>

<p>These things are really key, because everything else in the system is based on these values. If you change anything, be sure to adjust the rest of the system accordingly.</p>

<p><img src="/images/lamp-hw/detail-led-strip.jpg" alt="LED Stri Detail" /></p>

<h2 id="next-arduino">Next, Arduino</h2>

<p>I have come across <a href="http://www.rfduino.com/product/rfd22102-rfduino-dip/index.html">RFduino</a>. I have bought some basic kit when they were on Kickstarter, but I have since bought 6 more units. The trouble with this board is a bit in its availability. <a href="https://www.sparkfun.com/categories/274">Sparkfun</a> has it, but in the EU it is much more difficult to get your hands on it. I ended up buying from <a href="http://cz.mouser.com/new/rfdigital/rf-digital-rfduino/">Mouser</a>, but they are primarily a wholesale operation, so it’s expensive to buy small quantities from them.</p>

<p>Having said that, I’m really happy with RFduino, it is programmable with the Arduino IDE, has nice sample code and iOS libraries, uses Bluetooth 4.0 Low Energy, which is super nice and, most importantly, I have found the connectivity <em>great</em>, it just always works. It has also survived a couple of blunders on my part, such as connecting it to 5V power instead of the recommended 3.3V.</p>

<h2 id="power-supply">Power supply</h2>

<p>So my calculation went like this: I want a 1m long LED strip controlled by RFduino, that is 12V * 1A = 12W. So I need a 12W power supply. I ended up buying <a href="http://www.gmelectronic.com/power-ac-adapter-12v-1500ma-connector-2-1mm-mw-p751-193">this one</a> because it has enough power, nice connector and is relatively cheap.</p>

<h2 id="connecting-it-all-together">Connecting it all together</h2>

<p>Now I have a LED strip and a power supply which both operate at 12V, but I have a RFduino which operates at 3.3V. So the problem is twofold:</p>

<ol>
  <li>Convert 12V to 3.3V to power the RFduino</li>
  <li>Drive the 12V LED with the signal from RFduino</li>
</ol>

<p>This in the end translates into 2 subsystems that need to be designed. A power regulator circuit to power RFduino from 12V and an amplifier or a relay that could drive the LEDs.</p>

<h3 id="voltage-regulator-for-the-rfduino-12v-to-3v">Voltage Regulator for the RFduino 12V to 3V</h3>

<p>This was the hardest part to figure out for me. I didn’t want anything overly complicated and in the end I’ve settled for the <a href="http://www.ti.com/product/lp2950-33">LP2950-33</a> (<a href="http://www.onsemi.com/pub_link/Collateral/LP2950-D.PDF">Datasheet</a>). It looks like a transistor, has 3 legs, one for input, one for output and one for ground. The usual usage example I found involved capacitors between output and ground and optionally between input and ground to further stabilize the voltage. LP2950 comes in different varietes, so I chose the one that had it’s output voltage closest to RFduino’s 3V.</p>

<h3 id="darlington-array-to-drive-the-led-strip">Darlington Array to drive the LED Strip</h3>

<p>The last thing to do was to bring the PWM pin output from RFduino into the strip. The way the strip is connected is that there is a +12V cable and three different grounds, one for each of the RGB channels. So basically what the darlington does, is connect each of the RGB channels to the ground such, that the amount of current flowing through them can be controlled by RFduino.</p>

<p><img src="/images/lamp-hw/finished-wiring.jpg" alt="Finished prototype board - wiring" /></p>

<h2 id="the-prototype">The Prototype</h2>

<p>I have built the prototype using an universal board with headers bought from <a href="http://www.aliexpress.com/snapshot/6468939297.html?orderId=65605779553704">Aliexpress</a> so that I can plug the RFduino in and out as I please. This is what it looks like when I turn it on:</p>

<p><img src="/images/lamp-hw/finished-on.jpg" alt="Finished prototype turned on" /></p>

        
            
        
            
        
        <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'mirosval'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

    </section>
      <footer>
        
      </footer>
    </div>
    <script src="/javascripts/scale.fix.js"></script>
    <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-44114682-1");
  pageTracker._trackPageview();
  } catch(err) {}
</script>

    <div class="clear"></div>
  </body>
</html>

